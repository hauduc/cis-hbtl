library(tidyverse)

# Read in data
rpkms <- data.frame(rpkm = c(18, 34, 55, 12, 22, 7, 272, 17, 152, 310, 461),
                    rs75071948_allele = c("ref", "ref", "ref", "ref", "ref", "ref", "alt", "ref", "ref", "alt", "alt"),
                    sample_type = c(rep("primary", 8), rep("cell_line", 3)))

# Two-way ANOVA
rpkms_aov <- rpkms %>% aov(rpkm ~ sample_type * rs75071948_allele, data = .)

# Summarize differences between groups
rpkms_aov %>% summary()

# Residuals vs fitted values
rpkms_aov %>% plot(1)

# Levene test for 
rpkms %>% leveneTest(rpkm ~ sample_type * rs75071948_allele, data = .)

rpkms_aov %>% plot(2)


rpkms_aov %>% Anova(type = "III")
