---
title: "Unique Peak and Variant Enrichment Analysis"
output: html_notebook
---
Load packages
```{r}
#!/gsc/software/linux-x86_64-centos7/R-4.1.0/lib64/R/bin/R
# R 4.1.3
# x86_64-centos7-linux-gnu
library(plyranges)
library(VariantAnnotation)
library(MutationalPatterns)
library(genomation)
library(Gviz)
library(BSgenome.Hsapiens.UCSC.hg38)
library(TxDb.Hsapiens.UCSC.hg38.knownGene)
library(biomaRt)
library(LDlinkR)
library(tidyverse)

const_canonical_chromosomes <- str_c("chr", c(1:22, "X", "Y"))
```

Data already loaded in 1_data_import.Rmd

1. Turn each peak for all peakfiles into single-base-pair center dot (.modified object)
2. Expand each single-basepair range from .modified object 200bp upstream and downstream
```{r}

```

3. Create new column "unique" with TRUE/FALSE based on if there is an intersection with the other dataset
4. Pull out the "peak_name" and "unique" columns as a key:value pair from .modified GRanges
5. Annotate original peak GRanges with "unique" column by merging on "peak_name"
6. Merge original, annotated hg38 & wasp peak GRanges together with new "alignment_type" annotation column
7. Summarize number of unique peaks (subdivided by alignment type) (then transform to percent, then graph across cohort)
8. For each merged file, summarize mean number of SNP intersections per bp of peak for unique vs non-unique peaks (then graph across cohort)





