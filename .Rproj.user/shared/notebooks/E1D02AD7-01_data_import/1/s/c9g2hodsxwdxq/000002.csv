"0","# Load in all SPAAs"
"0","consensus.rpkm.bed.RData.files <- list.files(path = ""/projects/epigenomics3/epigenomics3_results/users/ahauduc/arp/project/modules/2/output2/spaas/annotated_rpkm"", "
"0","                                             pattern = ""*RData$"", "
"0","                                             full.names = TRUE)"
"0",""
"0","consensus.all.spaas.rpkm.bed <- data.frame()"
"0","for (i in seq_along(consensus.rpkm.bed.RData.files)) {"
"0","  load(consensus.rpkm.bed.RData.files[i])"
"0","  consensus.all.spaas.rpkm.bed <- bind_rows(consensus.all.spaas.rpkm.bed, consensus.spaa.rpkm.bed)"
"0","  rm(consensus.spaa.rpkm.bed)"
"0","}"
"0",""
"0","# Fix and convert to GRanges"
"0","consensus.all.spaas.rpkm.bed <- consensus.all.spaas.rpkm.bed %>% "
"0","  rowwise() %>% "
"0","  mutate(RPKM_total    = sum(c_across(Individual_14_17_LP_DNA_RPKM:Individual_15_18_LC_RNA_DNA_RPKM)),"
"0","         RPKM_variance = var(c_across(Individual_14_17_LP_DNA_RPKM:Individual_15_18_LC_RNA_DNA_RPKM))) %>% "
"0","  as.data.frame() %>% "
"0","  mutate(rs = na_if(rs, ""NA"")) %>% "
"0","  makeGRangesFromDataFrame(keep.extra.columns = TRUE, "
"0","                           ignore.strand = TRUE, "
"0","                           starts.in.df.are.0based = TRUE,"
"0","                           seqinfo = seqinfo(BSgenome.Hsapiens.UCSC.hg38))"
