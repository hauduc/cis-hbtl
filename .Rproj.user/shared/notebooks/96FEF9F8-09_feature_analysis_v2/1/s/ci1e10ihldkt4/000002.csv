"0","all_overlaps <- tibble()"
"0","for (MARK in vector_marks) {"
"0","  for (CELLTYPE in vector_celltypes) {"
"0","    for (INDIVIDUAL in vector_individuals) {"
"0","      "
"0","      MODALITY <- str_c(MARK, CELLTYPE, sep = ""_"")"
"0","      "
"0","      # Get baseline peaks overlap fraction with each feature"
"0","      peak_frac_overlaps <- "
"0","        list_peak_wasp[[MODALITY]][[INDIVIDUAL]] %>% "
"0","        get_feature_frac_overlaps(features = txdb_grlist) %>% "
"0","        mutate(enrichment_type = ""peak"","
"0","               .before = feature)"
"0","      "
"0","      # Get cis-hBTLs overlap fraction with each feature"
"0","      cis_hBTL_frac_overlaps <- "
"0","        consensus.all.spaas.rpkm.bed %>% "
"0","        plyranges::filter(mark == MARK, celltype == CELLTYPE, get(INDIVIDUAL) == TRUE) %>% "
"0","        get_feature_frac_overlaps(features = txdb_grlist) %>% "
"0","        mutate(enrichment_type = ""cis-hBTL"","
"0","               .before = feature)"
"0","      "
"0","      # Join"
"0","      joined_overlaps <- "
"0","        bind_rows(peak_frac_overlaps,"
"0","                  cis_hBTL_frac_overlaps) %>% "
"0","        mutate(mark = MARK,"
"0","               celltype = CELLTYPE,"
"0","               individual = INDIVIDUAL,"
"0","               .before = feature)"
"0","      "
"0","      all_overlaps <-"
"0","        bind_rows(all_overlaps, joined_overlaps)"
"0","      "
"0","    }"
"0","  }"
"0","}"
